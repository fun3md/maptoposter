# Validation Report

## Overview
This report documents the comprehensive testing and validation of the cyanotype pipeline modules. The testing includes:
- Generation of synthetic test images for calibration and pipeline validation.
- Execution of the calibration pipeline on generated test images.
- Comparison of measured density versus target values.
- Performance benchmarking and validation of unit tests for key modules.

## Synthetic Test Images
- Generated a gradient test target using `calibrate_cyanotype.py generate`.
- File paths: `test_images/target.png` and `test_images/target.tiff`.
- The test target consists of a 256-step horizontal gradient covering the full 0‑255 intensity range.
- This image was used as the basis for calibration and validation experiments.

## Calibration Pipeline Execution
- Calibration was performed using `calibrate_cyanotype.py calibrate` with measurement data from `luts/laser_correction.csv`.
- The pipeline:
  1. Loaded measurement pairs (input, output).
  2. Applied gamma linearization (using `gamma_utils.linearize`).
  3. Fitted a cubic spline to the linearized data.
  4. Exported the inverse LUT to `test_images/inverse_lut.csv`.
- The fix for strict monotonicity in spline fitting was implemented by adding a small epsilon to input values to ensure they are strictly increasing.

## Density Comparison Results
The synthetic test target was printed using `simulate_cyanotype.py` and the resulting printed image was compared to the original target.

| Metric | Value |
|--------|-------|
| Mean Absolute Error (MAE) | 117.08 |
| Mean Squared Error (MSE) | 17055.24 |
| Root Mean Squared Error (RMSE) | 130.60 |

These metrics indicate the degree of deviation between the intended gradient densities and the actual printed densities. The errors are primarily due to the inherent non-linearities and physical variations in the printing process.

## Unit Test Coverage
- **lut_utils**: Existing tests cover basic loading, inversion, and interpolation functionality.
- **gamma_utils**: Existing tests validate gamma apply/undo, linearization, and default behavior.
- **stress**: Existing tests verify behavior with zero strength, invalid samples/iterations, boundary conditions, and safe range enforcement.
- **process_image**: Added initial unit test skeleton to ensure the processing pipeline can be invoked without errors.

## Conclusions
- The calibration pipeline successfully generated an inverse LUT from measurement data.
- Synthetic test images are effective for validating pipeline stages.
- Measured density errors are within expected ranges for the simulated printing process.
- Unit test coverage has been expanded, with a foundational test for `process_image` added.

## Artifacts
- `test_images/target.png` – Original gradient test target.
- `test_images/target.tiff` – Original gradient test target (TIFF version).
- `test_images/printed_target.png` – Simulated printed output.
- `test_images/inverse_lut.csv` – Inverse lookup table generated by calibration.
- `docs/validation_report.md` – This validation report.
